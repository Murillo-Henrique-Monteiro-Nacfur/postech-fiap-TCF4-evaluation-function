# =================================================
# CONFIGURAÇÃO PADRÃO (PARA PRODUÇÃO NO GOOGLE CLOUD)
# =================================================
quarkus.funqy.export=processNewEvaluation

# --- Configuração do Banco de Dados com Cloud SQL Auth Proxy (Seguro) ---
quarkus.datasource.db-kind=postgresql
quarkus.datasource.username=application

# --- Configuração de Diagnóstico ---
# Força o log em modo DEBUG para obtermos mais informações sobre a falha.
quarkus.log.level=DEBUG
# Define explicitamente o ID do projeto para evitar falhas de descoberta.
quarkus.google.cloud.project-id=neon-trilogy-479114-v8

# Busca a senha diretamente do Google Secret Manager.
# Substitua 'NOME_DA_SUA_SECRET' pelo nome da secret que você criou.
quarkus.datasource.password=${DB_PASSWORD}

# Conexão Segura via Cloud SQL
quarkus.datasource.jdbc.url=jdbc:postgresql://34.39.226.182:5432/postech-fiap-tcf4

#
#quarkus.datasource.cloud-sql.instance-connection-name=neon-trilogy-479114-v8:southamerica-east1:postech-fiap-tcf4-project
quarkus.datasource.cloud-sql.database-name=postech-fiap-tcf4
quarkus.datasource.jdbc.driver=org.postgresql.Driver

# --- Configuração do Hibernate com Panache ---
quarkus.hibernate-orm.database.generation=none
quarkus.hibernate-orm.log.sql=true

# quarkus.native.enable-ssl=true
quarkus.log.category."io.quarkus.google.cloud.sql".level=DEBUG
quarkus.log.category."com.google.cloud.sql".level=DEBUG

# =================================================
# PERFIL DE DESENVOLVIMENTO (PARA RODAR LOCALMENTE)
# Ativado com: mvn quarkus:dev
# =================================================
%dev.quarkus.funqy.export=processNewEvaluation

# --- Configuração do Banco de Dados para Docker Local ---
%dev.quarkus.datasource.db-kind=postgresql
%dev.quarkus.datasource.username=application
%dev.quarkus.datasource.password=l4rQ}5`~]]{f+M{$

# URL JDBC para conectar ao PostgreSQL rodando em Docker na porta padrão.
%dev.quarkus.datasource.jdbc.url=jdbc:postgresql://34.39.226.182:5432/postech-fiap-tcf4

# --- Configuração do Hibernate para Dev ---
%dev.quarkus.hibernate-orm.database.generation=none
%dev.quarkus.hibernate-orm.log.sql=true

# =================================================
# CONFIGURAÇÃO DE BUILD NATIVO DO GRAALVM
# Cada argumento em uma linha para evitar problemas de parsing e conflitos.
# =================================================

# --- Networking & Security ---
quarkus.native.additional-build-args[0]=--enable-http
quarkus.native.additional-build-args[1]=--enable-https
# A opção --enable-all-security-services está obsoleta, mas mantida por enquanto.
quarkus.native.additional-build-args[2]=--enable-all-security-services

# --- Google Cloud & Auth ---
quarkus.native.additional-build-args[3]=--initialize-at-run-time=com.google.auth.oauth2.GoogleCredentials
quarkus.native.additional-build-args[4]=--initialize-at-run-time=com.google.cloud.pubsub.v1.Publisher
quarkus.native.additional-build-args[5]=--initialize-at-run-time=com.google.api.gax.core.GoogleCredentialsProvider
quarkus.native.additional-build-args[6]=--initialize-at-build-time=com.google.api.gax.core.AutoValue_InstantiatingExecutorProvider

# --- OpenTelemetry ---
quarkus.native.additional-build-args[7]=--initialize-at-run-time=io.opentelemetry.sdk.internal.AndroidFriendlyRandomHolder

# --- Narayana JTA (Transaction Manager) ---
quarkus.native.additional-build-args[8]=--initialize-at-run-time=com.arjuna.ats.internal.arjuna.recovery.PeriodicRecovery
quarkus.native.additional-build-args[9]=--initialize-at-run-time=com.arjuna.ats.internal.arjuna.recovery.ExpiredEntryMonitor
quarkus.native.additional-build-args[10]=--initialize-at-run-time=com.arjuna.ats.arjuna.recovery.RecoveryManager

# --- Netty Zstd Compression ---
quarkus.native.additional-build-args[11]=--initialize-at-run-time=io.netty.handler.codec.compression.ZstdConstants
